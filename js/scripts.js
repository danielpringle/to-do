"use strict";

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

// Create variables for our page elements
var form = document.querySelector('form');
var ul = document.querySelector('ul');
var clearAllButton = document.querySelector('button');
var input = document.getElementById('item'); // Let's create an empty array and set up a localStorage key called "items".

var itemsArray = localStorage.getItem('items') ? JSON.parse(localStorage.getItem('items')) : []; // We'll use JSON.stringify() to convert the data array to a string aslocalStorage only supports strings as values

localStorage.setItem('items', JSON.stringify(itemsArray)); // We'll use JSON.parse() to convert the contents of localStorage back into something we can work with later in the data variable.

var data = JSON.parse(localStorage.getItem('items')); // Add a class to our clearAllButton

clearAllButton.className = 'clear-all';
form.className = 'todo-form'; // We'll create a function to handle our progress bar.

/**
 * We'll create a function to display a progress bar.
 * We'll check how many current tasks there are and how many have been completed to get our percentage.
 */

var percentage = function percentage() {
  var totalTasks = document.querySelectorAll('li').length;
  var totalCompletedTasks = document.querySelectorAll('li .completed').length;
  var progress = Math.floor(totalCompletedTasks / totalTasks * 100);

  if (totalTasks > 0) {
    document.getElementById('task-progress').innerHTML = "".concat(progress, "%");
    document.getElementById('task-progress').style.width = "".concat(progress, "%");
  } else {
    document.getElementById('task-progress').innerHTML = '';
    document.getElementById('task-progress').style.width = '0%';
  }
};

percentage();
/**
 * Build out our li elemnet for each of our tasks.
 * Each li will need a checkbox, the inputted text and a delete button
 * Appends the list item to the ul.
 * We'll also run the percentage function again to update the frontend.
 */

var liMaker = function liMaker(text) {
  // create our variables
  var li = document.createElement('li');
  var deleteTaskButton = document.createElement('button');
  var checkbox = document.createElement('input');
  var labelContainer = document.createElement('label');
  var label = document.createElement('label');
  var labelText = document.createElement('span');
  li.setAttribute('draggable', 'true');
  li.className = 'draggable';
  ul.className = 'dropzone'; // Add classes and attributes

  li.setAttribute('draggable', 'true');
  li.className = 'draggable';
  ul.className = 'dropzone';
  labelContainer.className = 'container';
  label.className = 'newcheckmark';
  deleteTaskButton.className = 'delete';
  deleteTaskButton.innerHTML = '<ion-icon name="trash"></ion-icon>';
  labelText.textContent = text; // Create an event listener to remove individual tasks.

  function removeTaskLi(e) {
    e.target.closest('li').remove();
    percentage();
  }

  deleteTaskButton.addEventListener('click', removeTaskLi); // create our checkboxes and add unique ID

  for (var i = 0; i < itemsArray.length; i += 1) {
    checkbox.type = 'checkbox';
    checkbox.name = 'todo';
    checkbox.value = 'value';
    checkbox.id = "todo".concat(i);
    label.htmlFor = "todo".concat(i);
    li.id = "".concat(i);
  } // Add an event listener to toggle our completed class


  function completedTodo() {
    this.parentNode.classList.toggle('completed');
    percentage();
  }

  checkbox.addEventListener('click', completedTodo); // Build our li

  ul.appendChild(li);
  li.appendChild(labelContainer);
  labelContainer.appendChild(checkbox);
  labelContainer.appendChild(label);
  labelContainer.appendChild(labelText);
  labelContainer.appendChild(deleteTaskButton); // Build in draggable lists

  var draggables = document.querySelectorAll('.draggable');
  var containers = document.querySelectorAll('.dropzone');
  draggables.forEach(function (draggable) {
    draggable.addEventListener('dragstart', function () {
      // console.log('drag start');
      draggable.classList.add('dragging');
    });
    draggable.addEventListener('dragend', function () {
      draggable.classList.remove('dragging');
    });
  });

  function getDragAfterElement(container, y) {
    // console.log('fired');
    var draggableElements = _toConsumableArray(container.querySelectorAll('.draggable:not(.dragging)'));

    return draggableElements.reduce(function (closest, child) {
      var box = child.getBoundingClientRect();
      var offset = y - box.top - box.height / 2;

      if (offset < 0 && offset > closest.offset) {
        return {
          offset: offset,
          element: child
        };
      } else {
        return closest;
      }
    }, {
      offset: Number.NEGATIVE_INFINITY
    }).element;
  }

  containers.forEach(function (container) {
    container.addEventListener('dragover', function (e) {
      e.preventDefault();
      var afterElement = getDragAfterElement(container, e.clientY); // console.log('drag over');
      // console.log('afterElement');

      var draggable = document.querySelector('.dragging');

      if (afterElement == null) {
        container.appendChild(draggable);
      } else {
        container.insertBefore(draggable, afterElement);
      }
    });
  });
  /* */
};
/**
 * Create a task to listen for a submit event.
 * As we're not sending data to the server we'll use the e.preventDefault()
 * e.preventDefault() stops the form from doing the default submit action.
 */


function addTask(e) {
  e.preventDefault(); // We'll push any new input value into the array, then set the localStorage to the new, updated value.

  itemsArray.push(input.value);
  localStorage.setItem('items', JSON.stringify(itemsArray)); // Lets call the liMaker() function. This will create the item with the text of the input value and append it to the DOM.

  liMaker(input.value); // Lets set the input value to an empty string so we don't have to remove the last item entered manually.

  input.value = '';
}

form.addEventListener('submit', addTask);
/**
 * We'll loop through our items which has all the existing localStorage data in a form JavaScript can understand.
 * We'll run the liMaker() again to show display all the existing stored information on the front end every time the app is opened.
 */

data.forEach(function (item) {
  liMaker(item);
});
/**
 * Add an event listener to our 'clearAllButton' button that will clear all data from localStorage and remove every child from the ul.
 * We'll run the percentage function again to update the frontend.
 */

function removeAllTasks() {
  localStorage.clear();

  while (ul.firstChild) {
    ul.removeChild(ul.firstChild);
  }

  itemsArray = [];
  percentage();
}

clearAllButton.addEventListener('click', removeAllTasks);
/**
 * We'll create a function to get the current date.
 * We'll display the current date on the frontend.
 */

function beDate() {
  var currentDate = new Date();
  var year = currentDate.getFullYear();
  var date = currentDate.getDate();
  var weekday = new Array(7);
  weekday[0] = 'Sunday';
  weekday[1] = 'Monday';
  weekday[2] = 'Tuesday';
  weekday[3] = 'Wednesday';
  weekday[4] = 'Thursday';
  weekday[5] = 'Friday';
  weekday[6] = 'Saturday';
  var months = new Array(12);
  months[0] = 'January';
  months[1] = 'February';
  months[2] = 'March';
  months[3] = 'April';
  months[4] = 'May';
  months[5] = 'June';
  months[6] = 'July';
  months[7] = 'August';
  months[8] = 'September';
  months[9] = 'October';
  months[10] = 'November';
  months[11] = 'December';
  var displayWeekday = weekday[currentDate.getDay()];
  var displayMonth = months[currentDate.getMonth()];
  var formatted = "".concat(displayWeekday, ", ").concat(displayMonth, " ").concat(date, " ").concat(year);
  document.getElementById('display-date').innerHTML = formatted;
}

beDate();
/**
 * We'll create a function to get the current time.
 * We'll add a extra '0' to numbers less than 10 so 2 digets are always displayed on the frontend.
 * We'll set an interval around the function so the time updates in the browser every minute.
 */

function beCurrentTime() {
  var d = new Date();
  var x = document.getElementById('display-time');
  var h = (d.getHours() < 10 ? '0' : '') + d.getHours();
  var m = (d.getMinutes() < 10 ? '0' : '') + d.getMinutes(); // const s = (d.getSeconds() < 10 ? '0' : '') + d.getSeconds();

  x.innerHTML = "".concat(h, ":").concat(m);
}

beCurrentTime();
setInterval(function beTimeInterval1() {
  beCurrentTime();
}, 1000);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOlsiZm9ybSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInVsIiwiY2xlYXJBbGxCdXR0b24iLCJpbnB1dCIsImdldEVsZW1lbnRCeUlkIiwiaXRlbXNBcnJheSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwiZGF0YSIsImNsYXNzTmFtZSIsInBlcmNlbnRhZ2UiLCJ0b3RhbFRhc2tzIiwicXVlcnlTZWxlY3RvckFsbCIsImxlbmd0aCIsInRvdGFsQ29tcGxldGVkVGFza3MiLCJwcm9ncmVzcyIsIk1hdGgiLCJmbG9vciIsImlubmVySFRNTCIsInN0eWxlIiwid2lkdGgiLCJsaU1ha2VyIiwidGV4dCIsImxpIiwiY3JlYXRlRWxlbWVudCIsImRlbGV0ZVRhc2tCdXR0b24iLCJjaGVja2JveCIsImxhYmVsQ29udGFpbmVyIiwibGFiZWwiLCJsYWJlbFRleHQiLCJzZXRBdHRyaWJ1dGUiLCJ0ZXh0Q29udGVudCIsInJlbW92ZVRhc2tMaSIsImUiLCJ0YXJnZXQiLCJjbG9zZXN0IiwicmVtb3ZlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImkiLCJ0eXBlIiwibmFtZSIsInZhbHVlIiwiaWQiLCJodG1sRm9yIiwiY29tcGxldGVkVG9kbyIsInBhcmVudE5vZGUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJhcHBlbmRDaGlsZCIsImRyYWdnYWJsZXMiLCJjb250YWluZXJzIiwiZm9yRWFjaCIsImRyYWdnYWJsZSIsImFkZCIsImdldERyYWdBZnRlckVsZW1lbnQiLCJjb250YWluZXIiLCJ5IiwiZHJhZ2dhYmxlRWxlbWVudHMiLCJyZWR1Y2UiLCJjaGlsZCIsImJveCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIm9mZnNldCIsInRvcCIsImhlaWdodCIsImVsZW1lbnQiLCJOdW1iZXIiLCJORUdBVElWRV9JTkZJTklUWSIsInByZXZlbnREZWZhdWx0IiwiYWZ0ZXJFbGVtZW50IiwiY2xpZW50WSIsImluc2VydEJlZm9yZSIsImFkZFRhc2siLCJwdXNoIiwiaXRlbSIsInJlbW92ZUFsbFRhc2tzIiwiY2xlYXIiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJiZURhdGUiLCJjdXJyZW50RGF0ZSIsIkRhdGUiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJkYXRlIiwiZ2V0RGF0ZSIsIndlZWtkYXkiLCJBcnJheSIsIm1vbnRocyIsImRpc3BsYXlXZWVrZGF5IiwiZ2V0RGF5IiwiZGlzcGxheU1vbnRoIiwiZ2V0TW9udGgiLCJmb3JtYXR0ZWQiLCJiZUN1cnJlbnRUaW1lIiwiZCIsIngiLCJoIiwiZ2V0SG91cnMiLCJtIiwiZ2V0TWludXRlcyIsInNldEludGVydmFsIiwiYmVUaW1lSW50ZXJ2YWwxIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0EsSUFBTUEsSUFBSSxHQUFHQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsTUFBdkIsQ0FBYjtBQUNBLElBQU1DLEVBQUUsR0FBR0YsUUFBUSxDQUFDQyxhQUFULENBQXVCLElBQXZCLENBQVg7QUFDQSxJQUFNRSxjQUFjLEdBQUdILFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixRQUF2QixDQUF2QjtBQUNBLElBQU1HLEtBQUssR0FBR0osUUFBUSxDQUFDSyxjQUFULENBQXdCLE1BQXhCLENBQWQsQyxDQUNBOztBQUNBLElBQUlDLFVBQVUsR0FBR0MsWUFBWSxDQUFDQyxPQUFiLENBQXFCLE9BQXJCLElBQ2JDLElBQUksQ0FBQ0MsS0FBTCxDQUFXSCxZQUFZLENBQUNDLE9BQWIsQ0FBcUIsT0FBckIsQ0FBWCxDQURhLEdBRWIsRUFGSixDLENBR0E7O0FBQ0FELFlBQVksQ0FBQ0ksT0FBYixDQUFxQixPQUFyQixFQUE4QkYsSUFBSSxDQUFDRyxTQUFMLENBQWVOLFVBQWYsQ0FBOUIsRSxDQUNBOztBQUNBLElBQU1PLElBQUksR0FBR0osSUFBSSxDQUFDQyxLQUFMLENBQVdILFlBQVksQ0FBQ0MsT0FBYixDQUFx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QUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0EsU0FBU2UsYUFBVCxHQUF5QjtBQUN2QixNQUFNQyxDQUFDLEdBQUcsSUFBSWQsSUFBSixFQUFWO0FBQ0EsTUFBTWUsQ0FBQyxHQUFHckcsUUFBUSxDQUFDSyxjQUFULENBQXdCLGNBQXhCLENBQVY7QUFDQSxNQUFNaUcsQ0FBQyxHQUFHLENBQUNGLENBQUMsQ0FBQ0csUUFBRixLQUFlLEVBQWYsR0FBb0IsR0FBcEIsR0FBMEIsRUFBM0IsSUFBaUNILENBQUMsQ0FBQ0csUUFBRixFQUEzQztBQUNBLE1BQU1DLENBQUMsR0FBRyxDQUFDSixDQUFDLENBQUNLLFVBQUYsS0FBaUIsRUFBakIsR0FBc0IsR0FBdEIsR0FBNEIsRUFBN0IsSUFBbUNMLENBQUMsQ0FBQ0ssVUFBRixFQUE3QyxDQUp1QixDQUt2Qjs7QUFDQUosRUFBQUEsQ0FBQyxDQUFDOUUsU0FBRixhQUFpQitFLENBQWpCLGNBQXNCRSxDQUF0QjtBQUNEOztBQUNETCxhQUFhO0FBRWJPLFdBQVcsQ0FBQyxTQUFTQyxlQUFULEdBQTJCO0FBQ3JDUixFQUFBQSxhQUFhO0FBQ2QsQ0FGVSxFQUVSLElBRlEsQ0FBWCIsInNvdXJjZXNDb250ZW50IjpbIi8vIENyZWF0ZSB2YXJpYWJsZXMgZm9yIG91ciBwYWdlIGVsZW1lbnRzXG5jb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybScpO1xuY29uc3QgdWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpO1xuY29uc3QgY2xlYXJBbGxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdidXR0b24nKTtcbmNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2l0ZW0nKTtcbi8vIExldCdzIGNyZWF0ZSBhbiBlbXB0eSBhcnJheSBhbmQgc2V0IHVwIGEgbG9jYWxTdG9yYWdlIGtleSBjYWxsZWQgXCJpdGVtc1wiLlxubGV0IGl0ZW1zQXJyYXkgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnaXRlbXMnKVxuICA/IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2l0ZW1zJykpXG4gIDogW107XG4vLyBXZSdsbCB1c2UgSlNPTi5zdHJpbmdpZnkoKSB0byBjb252ZXJ0IHRoZSBkYXRhIGFycmF5IHRvIGEgc3RyaW5nIGFzbG9jYWxTdG9yYWdlIG9ubHkgc3VwcG9ydHMgc3RyaW5ncyBhcyB2YWx1ZXNcbmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdpdGVtcycsIEpTT04uc3RyaW5naWZ5KGl0ZW1zQXJyYXkpKTtcbi8vIFdlJ2xsIHVzZSBKU09OLnBhcnNlKCkgdG8gY29udmVydCB0aGUgY29udGVudHMgb2YgbG9jYWxTdG9yYWdlIGJhY2sgaW50byBzb21ldGhpbmcgd2UgY2FuIHdvcmsgd2l0aCBsYXRlciBpbiB0aGUgZGF0YSB2YXJpYWJsZS5cbmNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdpdGVtcycpKTtcblxuLy8gQWRkIGEgY2xhc3MgdG8gb3VyIGNsZWFyQWxsQnV0dG9uXG5jbGVhckFsbEJ1dHRvbi5jbGFzc05hbWUgPSAnY2xlYXItYWxsJztcbmZvcm0uY2xhc3NOYW1lID0gJ3RvZG8tZm9ybSc7XG5cbi8vIFdlJ2xsIGNyZWF0ZSBhIGZ1bmN0aW9uIHRvIGhhbmRsZSBvdXIgcHJvZ3Jlc3MgYmFyLlxuLyoqXG4gKiBXZSdsbCBjcmVhdGUgYSBmdW5jdGlvbiB0byBkaXNwbGF5IGEgcHJvZ3Jlc3MgYmFyLlxuICogV2UnbGwgY2hlY2sgaG93IG1hbnkgY3VycmVudCB0YXNrcyB0aGVyZSBhcmUgYW5kIGhvdyBtYW55IGhhdmUgYmVlbiBjb21wbGV0ZWQgdG8gZ2V0IG91ciBwZXJjZW50YWdlLlxuICovXG5jb25zdCBwZXJjZW50YWdlID0gKCkgPT4ge1xuICBjb25zdCB0b3RhbFRhc2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbGknKS5sZW5ndGg7XG4gIGNvbnN0IHRvdGFsQ29tcGxldGVkVGFza3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdsaSAuY29tcGxldGVkJykubGVuZ3RoO1xuICBjb25zdCBwcm9ncmVzcyA9IE1hdGguZmxvb3IoKHRvdGFsQ29tcGxldGVkVGFza3MgLyB0b3RhbFRhc2tzKSAqIDEwMCk7XG5cbiAgaWYgKHRvdGFsVGFza3MgPiAwKSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stcHJvZ3Jlc3MnKS5pbm5lckhUTUwgPSBgJHtwcm9ncmVzc30lYDtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1wcm9ncmVzcycpLnN0eWxlLndpZHRoID0gYCR7cHJvZ3Jlc3N9JWA7XG4gIH0gZWxzZSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stcHJvZ3Jlc3MnKS5pbm5lckhUTUwgPSAnJztcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1wcm9ncmVzcycpLnN0eWxlLndpZHRoID0gJzAlJztcbiAgfVxufTtcbnBlcmNlbnRhZ2UoKTtcblxuLyoqXG4gKiBCdWlsZCBvdXQgb3VyIGxpIGVsZW1uZXQgZm9yIGVhY2ggb2Ygb3VyIHRhc2tzLlxuICogRWFjaCBsaSB3aWxsIG5lZWQgYSBjaGVja2JveCwgdGhlIGlucHV0dGVkIHRleHQgYW5kIGEgZGVsZXRlIGJ1dHRvblxuICogQXBwZW5kcyB0aGUgbGlzdCBpdGVtIHRvIHRoZSB1bC5cbiAqIFdlJ2xsIGFsc28gcnVuIHRoZSBwZXJjZW50YWdlIGZ1bmN0aW9uIGFnYWluIHRvIHVwZGF0ZSB0aGUgZnJvbnRlbmQuXG4gKi9cbmNvbnN0IGxpTWFrZXIgPSAodGV4dCkgPT4ge1xuICAvLyBjcmVhdGUgb3VyIHZhcmlhYmxlc1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIGNvbnN0IGRlbGV0ZVRhc2tCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICBjb25zdCBsYWJlbENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgY29uc3QgbGFiZWxUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuXG4gIGxpLnNldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJywgJ3RydWUnKTtcbiAgbGkuY2xhc3NOYW1lID0gJ2RyYWdnYWJsZSc7XG4gIHVsLmNsYXNzTmFtZSA9ICdkcm9wem9uZSc7XG5cbiAgLy8gQWRkIGNsYXNzZXMgYW5kIGF0dHJpYnV0ZXNcbiAgbGkuc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCAndHJ1ZScpO1xuICBsaS5jbGFzc05hbWUgPSAnZHJhZ2dhYmxlJztcbiAgdWwuY2xhc3NOYW1lID0gJ2Ryb3B6b25lJztcbiAgbGFiZWxDb250YWluZXIuY2xhc3NOYW1lID0gJ2NvbnRhaW5lcic7XG4gIGxhYmVsLmNsYXNzTmFtZSA9ICduZXdjaGVja21hcmsnO1xuICBkZWxldGVUYXNrQnV0dG9uLmNsYXNzTmFtZSA9ICdkZWxldGUnO1xuICBkZWxldGVUYXNrQnV0dG9uLmlubmVySFRNTCA9ICc8aW9uLWljb24gbmFtZT1cInRyYXNoXCI+PC9pb24taWNvbj4nO1xuICBsYWJlbFRleHQudGV4dENvbnRlbnQgPSB0ZXh0O1xuXG4gIC8vIENyZWF0ZSBhbiBldmVudCBsaXN0ZW5lciB0byByZW1vdmUgaW5kaXZpZHVhbCB0YXNrcy5cbiAgZnVuY3Rpb24gcmVtb3ZlVGFza0xpKGUpIHtcbiAgICBlLnRhcmdldC5jbG9zZXN0KCdsaScpLnJlbW92ZSgpO1xuICAgIHBlcmNlbnRhZ2UoKTtcbiAgfVxuICBkZWxldGVUYXNrQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVtb3ZlVGFza0xpKTtcbiAgLy8gY3JlYXRlIG91ciBjaGVja2JveGVzIGFuZCBhZGQgdW5pcXVlIElEXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXNBcnJheS5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGNoZWNrYm94LnR5cGUgPSAnY2hlY2tib3gnO1xuICAgIGNoZWNrYm94Lm5hbWUgPSAndG9kbyc7XG4gICAgY2hlY2tib3gudmFsdWUgPSAndmFsdWUnO1xuICAgIGNoZWNrYm94LmlkID0gYHRvZG8ke2l9YDtcbiAgICBsYWJlbC5odG1sRm9yID0gYHRvZG8ke2l9YDtcbiAgICBsaS5pZCA9IGAke2l9YDtcbiAgfVxuICAvLyBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdG9nZ2xlIG91ciBjb21wbGV0ZWQgY2xhc3NcbiAgZnVuY3Rpb24gY29tcGxldGVkVG9kbygpIHtcbiAgICB0aGlzLnBhcmVudE5vZGUuY2xhc3NMaXN0LnRvZ2dsZSgnY29tcGxldGVkJyk7XG4gICAgcGVyY2VudGFnZSgpO1xuICB9XG4gIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY29tcGxldGVkVG9kbyk7XG4gIC8vIEJ1aWxkIG91ciBsaVxuICB1bC5hcHBlbmRDaGlsZChsaSk7XG4gIGxpLmFwcGVuZENoaWxkKGxhYmVsQ29udGFpbmVyKTtcbiAgbGFiZWxDb250YWluZXIuYXBwZW5kQ2hpbGQoY2hlY2tib3gpO1xuICBsYWJlbENvbnRhaW5lci5hcHBlbmRDaGlsZChsYWJlbCk7XG4gIGxhYmVsQ29udGFpbmVyLmFwcGVuZENoaWxkKGxhYmVsVGV4dCk7XG4gIGxhYmVsQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlbGV0ZVRhc2tCdXR0b24pO1xuXG4gIC8vIEJ1aWxkIGluIGRyYWdnYWJsZSBsaXN0c1xuICBjb25zdCBkcmFnZ2FibGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRyYWdnYWJsZScpO1xuICBjb25zdCBjb250YWluZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRyb3B6b25lJyk7XG5cbiAgZHJhZ2dhYmxlcy5mb3JFYWNoKChkcmFnZ2FibGUpID0+IHtcbiAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgKCkgPT4ge1xuICAgICAgLy8gY29uc29sZS5sb2coJ2RyYWcgc3RhcnQnKTtcbiAgICAgIGRyYWdnYWJsZS5jbGFzc0xpc3QuYWRkKCdkcmFnZ2luZycpO1xuICAgIH0pO1xuICAgIGRyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgKCkgPT4ge1xuICAgICAgZHJhZ2dhYmxlLmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdnaW5nJyk7XG4gICAgfSk7XG4gIH0pO1xuICBmdW5jdGlvbiBnZXREcmFnQWZ0ZXJFbGVtZW50KGNvbnRhaW5lciwgeSkge1xuICAgIC8vIGNvbnNvbGUubG9nKCdmaXJlZCcpO1xuICAgIGNvbnN0IGRyYWdnYWJsZUVsZW1lbnRzID0gW1xuICAgICAgLi4uY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5kcmFnZ2FibGU6bm90KC5kcmFnZ2luZyknKSxcbiAgICBdO1xuXG4gICAgcmV0dXJuIGRyYWdnYWJsZUVsZW1lbnRzLnJlZHVjZShcbiAgICAgIChjbG9zZXN0LCBjaGlsZCkgPT4ge1xuICAgICAgICBjb25zdCBib3ggPSBjaGlsZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0geSAtIGJveC50b3AgLSBib3guaGVpZ2h0IC8gMjtcbiAgICAgICAgaWYgKG9mZnNldCA8IDAgJiYgb2Zmc2V0ID4gY2xvc2VzdC5vZmZzZXQpIHtcbiAgICAgICAgICByZXR1cm4geyBvZmZzZXQ6IG9mZnNldCwgZWxlbWVudDogY2hpbGQgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gY2xvc2VzdDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHsgb2Zmc2V0OiBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgfVxuICAgICkuZWxlbWVudDtcbiAgfVxuXG4gIGNvbnRhaW5lcnMuZm9yRWFjaCgoY29udGFpbmVyKSA9PiB7XG4gICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGNvbnN0IGFmdGVyRWxlbWVudCA9IGdldERyYWdBZnRlckVsZW1lbnQoY29udGFpbmVyLCBlLmNsaWVudFkpO1xuICAgICAgLy8gY29uc29sZS5sb2coJ2RyYWcgb3ZlcicpO1xuICAgICAgLy8gY29uc29sZS5sb2coJ2FmdGVyRWxlbWVudCcpO1xuICAgICAgY29uc3QgZHJhZ2dhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRyYWdnaW5nJyk7XG4gICAgICBpZiAoYWZ0ZXJFbGVtZW50ID09IG51bGwpIHtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRyYWdnYWJsZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb250YWluZXIuaW5zZXJ0QmVmb3JlKGRyYWdnYWJsZSwgYWZ0ZXJFbGVtZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIC8qICovXG59O1xuXG4vKipcbiAqIENyZWF0ZSBhIHRhc2sgdG8gbGlzdGVuIGZvciBhIHN1Ym1pdCBldmVudC5cbiAqIEFzIHdlJ3JlIG5vdCBzZW5kaW5nIGRhdGEgdG8gdGhlIHNlcnZlciB3ZSdsbCB1c2UgdGhlIGUucHJldmVudERlZmF1bHQoKVxuICogZS5wcmV2ZW50RGVmYXVsdCgpIHN0b3BzIHRoZSBmb3JtIGZyb20gZG9pbmcgdGhlIGRlZmF1bHQgc3VibWl0IGFjdGlvbi5cbiAqL1xuZnVuY3Rpb24gYWRkVGFzayhlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICAvLyBXZSdsbCBwdXNoIGFueSBuZXcgaW5wdXQgdmFsdWUgaW50byB0aGUgYXJyYXksIHRoZW4gc2V0IHRoZSBsb2NhbFN0b3JhZ2UgdG8gdGhlIG5ldywgdXBkYXRlZCB2YWx1ZS5cbiAgaXRlbXNBcnJheS5wdXNoKGlucHV0LnZhbHVlKTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2l0ZW1zJywgSlNPTi5zdHJpbmdpZnkoaXRlbXNBcnJheSkpO1xuICAvLyBMZXRzIGNhbGwgdGhlIGxpTWFrZXIoKSBmdW5jdGlvbi4gVGhpcyB3aWxsIGNyZWF0ZSB0aGUgaXRlbSB3aXRoIHRoZSB0ZXh0IG9mIHRoZSBpbnB1dCB2YWx1ZSBhbmQgYXBwZW5kIGl0IHRvIHRoZSBET00uXG4gIGxpTWFrZXIoaW5wdXQudmFsdWUpO1xuICAvLyBMZXRzIHNldCB0aGUgaW5wdXQgdmFsdWUgdG8gYW4gZW1wdHkgc3RyaW5nIHNvIHdlIGRvbid0IGhhdmUgdG8gcmVtb3ZlIHRoZSBsYXN0IGl0ZW0gZW50ZXJlZCBtYW51YWxseS5cbiAgaW5wdXQudmFsdWUgPSAnJztcbn1cbmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgYWRkVGFzayk7XG5cbi8qKlxuICogV2UnbGwgbG9vcCB0aHJvdWdoIG91ciBpdGVtcyB3aGljaCBoYXMgYWxsIHRoZSBleGlzdGluZyBsb2NhbFN0b3JhZ2UgZGF0YSBpbiBhIGZvcm0gSmF2YVNjcmlwdCBjYW4gdW5kZXJzdGFuZC5cbiAqIFdlJ2xsIHJ1biB0aGUgbGlNYWtlcigpIGFnYWluIHRvIHNob3cgZGlzcGxheSBhbGwgdGhlIGV4aXN0aW5nIHN0b3JlZCBpbmZvcm1hdGlvbiBvbiB0aGUgZnJvbnQgZW5kIGV2ZXJ5IHRpbWUgdGhlIGFwcCBpcyBvcGVuZWQuXG4gKi9cblxuZGF0YS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gIGxpTWFrZXIoaXRlbSk7XG59KTtcblxuLyoqXG4gKiBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgdG8gb3VyICdjbGVhckFsbEJ1dHRvbicgYnV0dG9uIHRoYXQgd2lsbCBjbGVhciBhbGwgZGF0YSBmcm9tIGxvY2FsU3RvcmFnZSBhbmQgcmVtb3ZlIGV2ZXJ5IGNoaWxkIGZyb20gdGhlIHVsLlxuICogV2UnbGwgcnVuIHRoZSBwZXJjZW50YWdlIGZ1bmN0aW9uIGFnYWluIHRvIHVwZGF0ZSB0aGUgZnJvbnRlbmQuXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZUFsbFRhc2tzKCkge1xuICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbiAgd2hpbGUgKHVsLmZpcnN0Q2hpbGQpIHtcbiAgICB1bC5yZW1vdmVDaGlsZCh1bC5maXJzdENoaWxkKTtcbiAgfVxuICBpdGVtc0FycmF5ID0gW107XG4gIHBlcmNlbnRhZ2UoKTtcbn1cbmNsZWFyQWxsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVtb3ZlQWxsVGFza3MpO1xuXG4vKipcbiAqIFdlJ2xsIGNyZWF0ZSBhIGZ1bmN0aW9uIHRvIGdldCB0aGUgY3VycmVudCBkYXRlLlxuICogV2UnbGwgZGlzcGxheSB0aGUgY3VycmVudCBkYXRlIG9uIHRoZSBmcm9udGVuZC5cbiAqL1xuZnVuY3Rpb24gYmVEYXRlKCkge1xuICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XG4gIGNvbnN0IHllYXIgPSBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpO1xuICBjb25zdCBkYXRlID0gY3VycmVudERhdGUuZ2V0RGF0ZSgpO1xuICBjb25zdCB3ZWVrZGF5ID0gbmV3IEFycmF5KDcpO1xuICB3ZWVrZGF5WzBdID0gJ1N1bmRheSc7XG4gIHdlZWtkYXlbMV0gPSAnTW9uZGF5JztcbiAgd2Vla2RheVsyXSA9ICdUdWVzZGF5JztcbiAgd2Vla2RheVszXSA9ICdXZWRuZXNkYXknO1xuICB3ZWVrZGF5WzRdID0gJ1RodXJzZGF5JztcbiAgd2Vla2RheVs1XSA9ICdGcmlkYXknO1xuICB3ZWVrZGF5WzZdID0gJ1NhdHVyZGF5JztcblxuICBjb25zdCBtb250aHMgPSBuZXcgQXJyYXkoMTIpO1xuICBtb250aHNbMF0gPSAnSmFudWFyeSc7XG4gIG1vbnRoc1sxXSA9ICdGZWJydWFyeSc7XG4gIG1vbnRoc1syXSA9ICdNYXJjaCc7XG4gIG1vbnRoc1szXSA9ICdBcHJpbCc7XG4gIG1vbnRoc1s0XSA9ICdNYXknO1xuICBtb250aHNbNV0gPSAnSnVuZSc7XG4gIG1vbnRoc1s2XSA9ICdKdWx5JztcbiAgbW9udGhzWzddID0gJ0F1Z3VzdCc7XG4gIG1vbnRoc1s4XSA9ICdTZXB0ZW1iZXInO1xuICBtb250aHNbOV0gPSAnT2N0b2Jlcic7XG4gIG1vbnRoc1sxMF0gPSAnTm92ZW1iZXInO1xuICBtb250aHNbMTFdID0gJ0RlY2VtYmVyJztcblxuICBjb25zdCBkaXNwbGF5V2Vla2RheSA9IHdlZWtkYXlbY3VycmVudERhdGUuZ2V0RGF5KCldO1xuICBjb25zdCBkaXNwbGF5TW9udGggPSBtb250aHNbY3VycmVudERhdGUuZ2V0TW9udGgoKV07XG4gIGNvbnN0IGZvcm1hdHRlZCA9IGAke2Rpc3BsYXlXZWVrZGF5fSwgJHtkaXNwbGF5TW9udGh9ICR7ZGF0ZX0gJHt5ZWFyfWA7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXNwbGF5LWRhdGUnKS5pbm5lckhUTUwgPSBmb3JtYXR0ZWQ7XG59XG5iZURhdGUoKTtcbi8qKlxuICogV2UnbGwgY3JlYXRlIGEgZnVuY3Rpb24gdG8gZ2V0IHRoZSBjdXJyZW50IHRpbWUuXG4gKiBXZSdsbCBhZGQgYSBleHRyYSAnMCcgdG8gbnVtYmVycyBsZXNzIHRoYW4gMTAgc28gMiBkaWdldHMgYXJlIGFsd2F5cyBkaXNwbGF5ZWQgb24gdGhlIGZyb250ZW5kLlxuICogV2UnbGwgc2V0IGFuIGludGVydmFsIGFyb3VuZCB0aGUgZnVuY3Rpb24gc28gdGhlIHRpbWUgdXBkYXRlcyBpbiB0aGUgYnJvd3NlciBldmVyeSBtaW51dGUuXG4gKi9cbmZ1bmN0aW9uIGJlQ3VycmVudFRpbWUoKSB7XG4gIGNvbnN0IGQgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCB4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rpc3BsYXktdGltZScpO1xuICBjb25zdCBoID0gKGQuZ2V0SG91cnMoKSA8IDEwID8gJzAnIDogJycpICsgZC5nZXRIb3VycygpO1xuICBjb25zdCBtID0gKGQuZ2V0TWludXRlcygpIDwgMTAgPyAnMCcgOiAnJykgKyBkLmdldE1pbnV0ZXMoKTtcbiAgLy8gY29uc3QgcyA9IChkLmdldFNlY29uZHMoKSA8IDEwID8gJzAnIDogJycpICsgZC5nZXRTZWNvbmRzKCk7XG4gIHguaW5uZXJIVE1MID0gYCR7aH06JHttfWA7XG59XG5iZUN1cnJlbnRUaW1lKCk7XG5cbnNldEludGVydmFsKGZ1bmN0aW9uIGJlVGltZUludGVydmFsMSgpIHtcbiAgYmVDdXJyZW50VGltZSgpO1xufSwgMTAwMCk7XG4iXSwiZmlsZSI6InNjcmlwdHMuanMifQ==
